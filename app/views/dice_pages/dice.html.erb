<%= render "shared/content_card" do %>
  <div class="text-center mb-8">
    <h1 class="text-5xl md:text-5xl font-extrabold text-black mb-5">
       運命の選択
    </h1>
    <div class="lists space-y-6 text-center mb-8 bg-black text-white p-12">
      <div class="flex items-center justify-center gap-6">
        <img id="dice" src="<%= asset_path("dice1.jpg") %>" 
             class="w-30 h-30 object-cover rounded-lg">
      </div>
      <div id="diceResult" class="mt-6 font-bold text-yellow-400 opacity-0 transition-opacity duration-500">
        50m
      </div>
      <div class="text-lg text-white mt-2" id="messageText">
        運動会の練習にどうぞ！
      </div>
    </div>
    <h2 class="text-3xl font-semibold text-black mb-5">Set</h2>
    <p class="font-medium text-black mb-5">好きなタイミングで止めよう!</p>
    <button id="diceBtn" 
            class="inline-block px-10 py-4 bg-black text-white text-lg md:font-bold rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-200">
      さいころを振る
    </button>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const diceArray = [
        '<%= asset_path("dice1.jpg") %>',
        '<%= asset_path("dice2.jpg") %>',
        '<%= asset_path("dice3.jpg") %>',
        '<%= asset_path("dice4.jpg") %>',
        '<%= asset_path("dice5.jpg") %>',
        '<%= asset_path("dice6.jpg") %>'
      ];

      const resultTexts = [
        '50m',
        '100m',
        '400m',
        '800m',
        '1500m',
        '42.195km'
      ];

      const messageTexts = [
        '運動会の練習にどうぞ！',
        '目指せ世界最速！',
        'トラック１周全力疾走！',
        '走る格闘技！',
        '持久走あなたは何分で走れるか！',
        'フルマラソンに挑戦だ！'
      ];


      const dice = document.getElementById("dice");
      const diceBtn = document.getElementById("diceBtn");
      const distanceText = document.getElementById("distanceText");
      const messageText = document.getElementById("messageText");

      let timerId;

      if (dice && diceBtn) {
        diceBtn.addEventListener("click", function(){
          if(diceBtn.textContent.trim() === 'さいころを振る'){
            diceBtn.textContent = 'ストップ';
            diceBtn.classList.add('bg-red-500');
            diceBtn.classList.remove('bg-black');

            diceResult.classList.add('opacity-0');
            
            timerId = setInterval(() => {
              let diceIndex = Math.floor(Math.random() * diceArray.length);
              dice.src = diceArray[diceIndex];


              diceResult.textContent = resultTexts[diceIndex];
              messageText.textContent = messageTexts[diceIndex];

            }, 10);
          } else {
            diceBtn.textContent = 'さいころを振る';
            diceBtn.classList.remove('bg-red-500');
            diceBtn.classList.add('bg-black');
            clearInterval(timerId);

            setTimeout(() => {
              diceResult.classList.remove('opacity-0');
            }, 200);
          }
        });
      }
    });
  </script>
<% end %>